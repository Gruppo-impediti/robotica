function pos = get_pos(q)

q1 = q(1);
q2 = q(2);
q3 = q(3);
q4 = q(4);
q5 = q(5);
q6 = q(6);
q7 = q(7);

% D-H parameters
a3 = 0.0825;
a4 = -0.0825;
a6 = 0.088;
d1 = 0.333;
d3 = 0.316;
d5 = 0.384;
d7 = 0.107;

A1 = [  cos(q1) 0 sin(q1) 0; ...
        sin(q1) 0 -cos(q1) 0; ...
         0 1 0 d1; ...
         0 0 0 1];
A2 = [  cos(q2) 0 -sin(q2) 0; ...
        sin(q2) 0 cos(q2) 0; ...
        0 -1 0 0; ...
        0 0 0 1];
    
A3 = [  cos(q3) 0 sin(q3) a3*cos(q3); ...
        sin(q3) 0 -cos(q3) a3*sin(q3); ...
        0 1 0 d3; ...
        0 0 0 1];
     
A4 = [  cos(q4) 0 -sin(q4) a4*cos(q4); ...
        sin(q4) 0 cos(q4) a4*sin(q4); ...
        0 -1 0 0; ...
         0 0 0 1];

A5 = [  cos(q5) 0 sin(q5) 0; ...
        sin(q5) 0 -cos(q5) 0; ...
        0 1 0 d5; ...
        0 0 0 1];
    
A6 = [  cos(q6) 0 sin(q6) a6*cos(q6); ...
        sin(q6) 0 -cos(q6) a6*sin(q6); ...
        0 1 0 0; ...
        0 0 0 1];
    
A7 = [  cos(q7) -sin(q7) 0 0; ...
        sin(q7) cos(q7) 0 0; ...
        0 0 1 d7; ...
        0 0 0 1];
    
pos = A1*(A2*(A3*(A4*(A5*(A6*(A7*[0 0 0 1]'))))));

pos = pos(1:3,1);

end

